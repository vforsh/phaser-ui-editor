### Edit Contexts (контексты редактирования)

`EditContext` — это “режим фокуса” на **конкретном контейнере** (группе) на Canvas. В каждый момент времени активен ровно один контекст: он определяет, **какие объекты можно выбирать/двигать/трансформировать** и как редактор должен реагировать на клики и перетаскивания.

По сути, Edit Context отвечает за то, чтобы редактирование UI было **предсказуемым**: вы работаете не со “всем деревом сразу”, а с выбранным уровнем иерархии (контейнером), как с отдельной сценой редактирования.

### Зачем это нужно

- **Фокус на уровне иерархии**: когда UI вложенный (контейнеры внутри контейнеров), важно уметь “зайти” в группу и работать только с её содержимым, не цепляя соседние или родительские объекты.
- **Безопасное редактирование**: активный контекст ограничивает интерактивность — клики и выделения применяются только к объектам, которые принадлежат текущему контейнеру.
- **Единая точка правды для выделения**: именно контекст решает, что считается “текущим выделением” на Canvas и когда оно меняется (а значит, когда должны обновиться Inspector и Hierarchy).

### Что даёт пользователю (поведение на Canvas)

- **Активный контекст**
  - Внутри активного контейнера объекты становятся “редактируемыми”: их можно выбирать, выделять рамкой, таскать, менять трансформами.
  - При переключении контекста предыдущий контекст “выключается”: выделение в нём сбрасывается, интерактивность у его объектов отключается.

- **Переходы между контекстами (навигация по группам)**
  - **Двойной клик по контейнеру**: “войти” в контейнер и начать редактировать его содержимое.
  - **Двойной клик по пустому месту на Canvas**: “выйти” на уровень выше (в родительский контейнер). Если родителя нет — переход в специальный верхний уровень (super root).

- **Выделение объектов**
  - **Клик по объекту**: выбрать один объект.
  - **Shift + клик**: добавить/убрать объект из текущего выделения (быстрое мультивыделение).
  - **Клик по пустому месту**: снять выделение.

- **Выделение рамкой (selection rect)**
  - Если начать тянуть мышь по пустому месту, появляется прямоугольник выделения.
  - Все объекты текущего контекста, попавшие в рамку, будут выбраны одним действием.
  - Во время рисования рамки редактор подсвечивает, какие элементы окажутся в выборе.

- **Трансформации (transform controls)**
  - Когда есть выделение, появляются контролы трансформации (ручки/границы) для изменения объекта(ов) — это “главный инструмент” работы с размещением на Canvas.
  - Можно перетаскивать выделение, чтобы двигать объект(ы) на сцене.
  - На время активных трансформаций подсветка/hover скрывается, чтобы не мешать и не создавать визуальный шум.

### Связь с остальными частями редактора

- **Inspector Panel**: слушает изменения выделения — когда контекст меняет selection, инспектор получает новый “текущий объект(ы)” для редактирования.
- **Hierarchy Panel**: выделение и активный контекст синхронизируются с состоянием Canvas, поэтому выбор в дереве и выбор на Canvas остаются согласованными.

### Важные принципы модели

- **Контекст создаётся на контейнер**: у каждого `EditableContainer` есть свой `EditContext`, который появляется автоматически.
- **Активен только один**: контексты существуют параллельно, но обновляется и реагирует на ввод только текущий активный.
- **Контекст — это не “файл/сцена”, а “область редактирования”**: он определяет границы интерактивности и все UX-правила выделения/перемещения на данном уровне.
